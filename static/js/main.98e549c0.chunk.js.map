{"version":3,"sources":["lib/helpers/serializer.js","lib/helpers/retry.js","lib/WebRTC.js","lib/helpers/BufferedEventEmitter.js","lib/Channel.js","lib/MultiChannel.js","lib/stores/SimpleStore.js","lib/index.js","utils.js","screens/Create.js","screens/Join.js","screens/Chat.js","App.js","index.js"],"names":["serializer","description","btoa","sdp","token","type","atob","retry","obj","key","func","Object","asyncToGenerator","regenerator_default","a","mark","_callee","wrap","_context","prev","next","t0","stop","WebRTC","config","classCallCheck","this","connection","_createConnection","dataChannel","createDataChannel","_configureDataChannel","createOffer","offer","setLocalDescription","Error","setRemoteDescription","createAnswer","answer","channel","store","get","sessionDescription","_getAnswerToken","_getSessionDescription","save","buffer","onmessage","e","data","push","onopen","connect","oniceconnectionstatechange","state","iceConnectionState","isDisconnected","isConnected","disconnect","onAnswer","_this","_callee7","_context7","getAnswer","sent","timeout","setUpTimeout","RTCPeerConnection","iceServers","Promise","resolve","onicecandidate","candidate","localDescription","binaryType","BufferedEventEmitter","possibleConstructorReturn","getPrototypeOf","call","_pendingEvents","event","hasListeners","esm_get","prototype","listener","isPending","it","filter","forEach","_ref","EventEmitter","Channel","arguments","length","undefined","uuid","$timeout","didDisconnect","didTimeout","_checkConnected","send","wasConnected","close","$waitAnswer","emit","_clearTimeout","_this2","_checkNotConnected","_this3","setTimeout","clearTimeout","MultiChannel","channel1","channel2","_handleConnection","bind","assertThisInitialized","_handleDisconnection","_handleData","selectedChannel","_subscribeChannel","_clean","getOtherChannel","on","_handleTimeout","otherChannel","$waitChannel2","SimpleStore","url","api","axios","create","baseURL","headers","cache","concat","then","_adaptResponse","value","encodeURIComponent","response","urls","webrtc","lib","createChannel","_createChannel","_callee2","_context2","createSingleChannel","joinSingleChannel","abrupt","apply","joinChannel","_joinChannel","_callee3","_context3","_x","_createSingleChannel","_callee4","id","_ref2","_context4","createConnectionWithOffer","setConnectHandler","setDisconnectHandler","setWaitHandler","setUpTimeoutFor","saveOffer","_x2","_joinSingleChannel","_callee5","_context5","getOffer","createConnectionWithAnswer","saveAnswer","ondatachannel","_ref3","_x3","setStore","newStore","setIceServers","newIceServers","newTimeout","utils","window","location","href","replace","hash","search","querystring","parse","Create","react_default","createElement","link","quickp2p","setState","alert","Component","Join","inviteToken","Chat","messages","input","join","readOnly","rows","ref","textarea","style","width","onChange","target","onKeyDown","_addMessage","focus","content","_this4","toConsumableArray","scrollTop","scrollHeight","App","route","startsWith","Create_Create","Join_Join","Chat_Chat","rel","_listener","addEventListener","forceUpdate","removeEventListener","ReactDOM","render","App_App","document","getElementById"],"mappings":"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","file":"static/js/main.98e549c0.chunk.js","sourcesContent":["export default {\n\tserialize(description) {\n\t\treturn btoa(description.sdp);\n\t},\n\n\tdeserialize(token, type) {\n\t\treturn { type, sdp: atob(token) };\n\t}\n};\n","export default (obj, key, func) => {\n\tobj[key] = async () => {\n\t\ttry {\n\t\t\tawait func();\n\t\t} catch (e) {\n\t\t\tif (obj[key]) obj[key]();\n\t\t}\n\t};\n\tobj[key]();\n};\n","import serializer from \"./helpers/serializer\";\nimport retry from \"./helpers/retry\";\n\nconst CHANNEL_NAME = \"data\";\nconst ANSWER_SUFFIX = \"-answer\";\n\nexport default class WebRTC {\n\tconstructor(config) {\n\t\tthis.config = config;\n\t}\n\n\tasync createConnectionWithOffer() {\n\t\ttry {\n\t\t\tconst connection = this._createConnection();\n\t\t\tconst dataChannel = connection.createDataChannel(CHANNEL_NAME);\n\t\t\tthis._configureDataChannel(dataChannel);\n\t\t\tconst offer = await connection.createOffer();\n\t\t\tawait connection.setLocalDescription(offer);\n\t\t\treturn { connection, dataChannel };\n\t\t} catch (e) {\n\t\t\tthrow new Error(\"Error initializing channel: Cannot create offer\");\n\t\t}\n\t}\n\n\tasync createConnectionWithAnswer(offer) {\n\t\ttry {\n\t\t\tconst connection = this._createConnection();\n\t\t\tawait connection.setRemoteDescription(offer);\n\t\t\tconst answer = await connection.createAnswer();\n\t\t\tawait connection.setLocalDescription(answer);\n\t\t\treturn connection;\n\t\t} catch (e) {\n\t\t\tthrow new Error(\"Error initializing channel: Cannot create answer\");\n\t\t}\n\t}\n\n\tasync getOffer(channel) {\n\t\ttry {\n\t\t\tconst sessionDescription = await this.store.get(channel.token);\n\t\t\treturn serializer.deserialize(sessionDescription, \"offer\");\n\t\t} catch (e) {\n\t\t\tthrow new Error(\"Error joining channel: Cannot read offer data\");\n\t\t}\n\t}\n\n\tasync getAnswer(channel) {\n\t\ttry {\n\t\t\tconst sessionDescription = await this.store.get(\n\t\t\t\tthis._getAnswerToken(channel)\n\t\t\t);\n\t\t\treturn serializer.deserialize(sessionDescription, \"answer\");\n\t\t} catch (e) {\n\t\t\tthrow new Error(\"Error joining channel: Cannot read answer data\");\n\t\t}\n\t}\n\n\tasync saveOffer(connection, channel) {\n\t\ttry {\n\t\t\tconst sessionDescription = await this._getSessionDescription(connection);\n\t\t\tawait this.store.save(channel.token, sessionDescription);\n\t\t} catch (e) {\n\t\t\tthrow new Error(\"Error initializing channel: Cannot write offer data\");\n\t\t}\n\t}\n\n\tasync saveAnswer(connection, channel) {\n\t\ttry {\n\t\t\tconst sessionDescription = await this._getSessionDescription(connection);\n\t\t\tawait this.store.save(this._getAnswerToken(channel), sessionDescription);\n\t\t} catch (e) {\n\t\t\tthrow new Error(\"Error initializing channel: Cannot write answer data\");\n\t\t}\n\t}\n\n\tsetConnectHandler(connection, dataChannel, channel) {\n\t\tthis._configureDataChannel(dataChannel);\n\t\tdataChannel.buffer = [];\n\n\t\tdataChannel.onmessage = (e) => {\n\t\t\tconst data = e.data;\n\t\t\tif (data) dataChannel.buffer.push(data);\n\t\t};\n\n\t\tdataChannel.onopen = () => channel.connect(connection, dataChannel);\n\t}\n\n\tsetDisconnectHandler(connection, channel) {\n\t\tconnection.oniceconnectionstatechange = (e) => {\n\t\t\tconst state = connection.iceConnectionState;\n\t\t\tconst isDisconnected =\n\t\t\t\tstate === \"failed\" || state === \"disconnected\" || state === \"closed\";\n\t\t\tif (channel.isConnected && isDisconnected) channel.disconnect();\n\t\t};\n\t}\n\n\tsetWaitHandler(connection, channel, onAnswer) {\n\t\tretry(channel, \"$waitAnswer\", async () => {\n\t\t\tconst answer = await this.getAnswer(channel);\n\t\t\tawait connection.setRemoteDescription(answer);\n\t\t\tonAnswer();\n\t\t});\n\t}\n\n\tsetUpTimeoutFor(channel) {\n\t\tconst { timeout } = this.config;\n\t\tchannel.setUpTimeout(timeout);\n\t}\n\n\tget store() {\n\t\tconst { store } = this.config;\n\t\tif (!store) throw new Error(\"Store not set, use `.setStore(...)`\");\n\n\t\treturn store;\n\t}\n\n\t_createConnection() {\n\t\treturn new RTCPeerConnection({ iceServers: this.config.iceServers });\n\t}\n\n\t_getSessionDescription(connection) {\n\t\treturn new Promise((resolve) => {\n\t\t\tconnection.onicecandidate = (e) => {\n\t\t\t\tif (e.candidate !== null) return;\n\t\t\t\tresolve(serializer.serialize(connection.localDescription));\n\t\t\t};\n\t\t});\n\t}\n\n\t_getAnswerToken(channel) {\n\t\treturn channel.token + ANSWER_SUFFIX;\n\t}\n\n\t_configureDataChannel(dataChannel) {\n\t\tdataChannel.binaryType = \"arraybuffer\";\n\t}\n}\n","import EventEmitter from \"eventemitter3\";\n\nexport default class BufferedEventEmitter extends EventEmitter {\n\tconstructor() {\n\t\tsuper();\n\n\t\tthis._pendingEvents = [];\n\t}\n\n\temit(event, data) {\n\t\tconst hasListeners = super.emit(event, data);\n\t\tif (!hasListeners) this._pendingEvents.push({ event, data });\n\t\treturn hasListeners;\n\t}\n\n\ton(event, listener) {\n\t\tsuper.on(event, listener);\n\n\t\tconst isPending = (it) => it.event === event;\n\t\tthis._pendingEvents\n\t\t\t.filter(isPending)\n\t\t\t.forEach(({ event, data }) => listener(data));\n\t\tthis._pendingEvents = this._pendingEvents.filter((it) => !isPending(it));\n\n\t\treturn this;\n\t}\n}\n","import BufferedEventEmitter from \"./helpers/BufferedEventEmitter\";\nimport uuid from \"uuid/v1\";\n\nexport default class Channel extends BufferedEventEmitter {\n\tconstructor(token = uuid()) {\n\t\tsuper();\n\n\t\tthis.token = token;\n\t\tthis.connection = null;\n\t\tthis.dataChannel = null;\n\t\tthis.$timeout = null;\n\n\t\tthis.didDisconnect = false;\n\t\tthis.didTimeout = false;\n\t}\n\n\tsend(data) {\n\t\tthis._checkConnected();\n\n\t\tthis.dataChannel.send(data);\n\t}\n\n\tdisconnect() {\n\t\tthis.didDisconnect = true;\n\n\t\tconst wasConnected = this.isConnected;\n\t\tif (this.dataChannel) this.dataChannel.close();\n\t\tif (this.connection) this.connection.close();\n\n\t\tthis.connection = null;\n\t\tthis.dataChannel = null;\n\t\tthis.$waitAnswer = null;\n\t\tif (wasConnected) this.emit(\"disconnected\");\n\t\tthis._clearTimeout();\n\t}\n\n\tconnect(connection, dataChannel) {\n\t\tthis._checkNotConnected();\n\n\t\tthis.connection = connection;\n\t\tthis.dataChannel = dataChannel;\n\n\t\tconst run = (data) => this.emit(\"data\", data);\n\t\tif (dataChannel.buffer) {\n\t\t\tdataChannel.buffer.forEach(run);\n\t\t\tdelete dataChannel.buffer;\n\t\t}\n\n\t\tthis.dataChannel.onmessage = (e) => {\n\t\t\tconst data = e.data;\n\t\t\tif (!data) return;\n\n\t\t\tthis.emit(\"data\", data);\n\t\t};\n\t\tthis.emit(\"connected\");\n\t\tthis._clearTimeout();\n\t}\n\n\tsetUpTimeout(timeout) {\n\t\tthis.$timeout = setTimeout(() => {\n\t\t\tif (!this.isConnected) {\n\t\t\t\tthis.didTimeout = true;\n\n\t\t\t\tthis.disconnect();\n\t\t\t\tthis.emit(\"timeout\");\n\t\t\t}\n\t\t}, timeout);\n\t}\n\n\tget isConnected() {\n\t\treturn this.dataChannel !== null;\n\t}\n\n\t_clearTimeout() {\n\t\tclearTimeout(this.$timeout);\n\t\tthis.$timeout = null;\n\t}\n\n\t_checkConnected() {\n\t\tif (!this.isConnected) throw new Error(\"Error: Not connected\");\n\t}\n\n\t_checkNotConnected() {\n\t\tif (this.isConnected) throw new Error(\"Error: Already connected\");\n\t}\n}\n","import BufferedEventEmitter from \"./helpers/BufferedEventEmitter\";\n\nexport default class MultiChannel extends BufferedEventEmitter {\n\tconstructor(channel1, channel2) {\n\t\tsuper();\n\n\t\tthis._handleConnection = this._handleConnection.bind(this);\n\t\tthis._handleDisconnection = this._handleDisconnection.bind(this);\n\t\tthis._handleData = this._handleData.bind(this);\n\n\t\tthis.channel1 = channel1;\n\t\tthis.channel2 = null;\n\t\tthis.selectedChannel = null;\n\n\t\tthis._subscribeChannel(this.channel1, () => this.channel2);\n\t\tif (channel2) this.connect(channel2);\n\n\t\tthis.didTimeout = false;\n\t}\n\n\tsend(data) {\n\t\tthis._checkConnected();\n\n\t\tthis.selectedChannel.send(data);\n\t}\n\n\tdisconnect() {\n\t\tthis.channel1.disconnect();\n\t\tif (this.channel2) this.channel2.disconnect();\n\t\tthis._clean();\n\t}\n\n\tconnect(channel2) {\n\t\tthis.channel2 = channel2;\n\t\tthis._subscribeChannel(this.channel2, () => this.channel1);\n\t}\n\n\tget token() {\n\t\treturn this.channel1.token;\n\t}\n\n\tget isConnected() {\n\t\treturn this.selectedChannel !== null;\n\t}\n\n\t_checkConnected() {\n\t\tif (!this.isConnected) throw new Error(\"Error: Not connected\");\n\t}\n\n\t_subscribeChannel(channel, getOtherChannel) {\n\t\tchannel\n\t\t\t.on(\"connected\", () => {\n\t\t\t\tthis._handleConnection(channel);\n\t\t\t})\n\t\t\t.on(\"disconnected\", () => {\n\t\t\t\tthis._handleDisconnection(channel, getOtherChannel());\n\t\t\t})\n\t\t\t.on(\"timeout\", () => {\n\t\t\t\tthis._handleTimeout(channel, getOtherChannel());\n\t\t\t})\n\t\t\t.on(\"data\", this._handleData);\n\t}\n\n\t_handleConnection(channel) {\n\t\tif (this.isConnected) return;\n\n\t\tthis.selectedChannel = channel;\n\t\tthis.emit(\"connected\");\n\t}\n\n\t_handleDisconnection(channel, otherChannel) {\n\t\tconst wasConnected = this.isConnected;\n\n\t\tif (otherChannel && otherChannel.isConnected)\n\t\t\tthis.selectedChannel = otherChannel;\n\t\telse if (wasConnected) {\n\t\t\tthis._clean();\n\t\t\tthis.emit(\"disconnected\");\n\t\t}\n\t}\n\n\t_handleTimeout(channel, otherChannel) {\n\t\tif (\n\t\t\t(channel.didTimeout || otherChannel.didTimeout) &&\n\t\t\t!this.isConnected &&\n\t\t\t!this.didTimeout\n\t\t) {\n\t\t\tthis.didTimeout = true;\n\n\t\t\tthis.disconnect();\n\t\t\tthis.emit(\"timeout\");\n\t\t}\n\t}\n\n\t_handleData(data) {\n\t\tthis.emit(\"data\", data);\n\t}\n\n\t_clean() {\n\t\tthis.selectedChannel = null;\n\t\tthis.$waitChannel2 = null;\n\t}\n}\n","import axios from \"axios\";\n\nexport default class SimpleStore {\n\tconstructor(url) {\n\t\tthis.api = axios.create({\n\t\t\tbaseURL: url,\n\t\t\theaders: { cache: \"no-cache\" }\n\t\t});\n\t}\n\n\tget(key) {\n\t\treturn this.api.get(`get/${key}`).then(this._adaptResponse);\n\t}\n\n\tsave(key, value) {\n\t\tconst data = encodeURIComponent(value);\n\t\treturn this.api.get(`set/${key}/${data}`).then(this._adaptResponse);\n\t}\n\n\t_adaptResponse(response) {\n\t\tconst { data } = response;\n\t\treturn data.value;\n\t}\n}\n","import WebRTC from \"./WebRTC\";\nimport Channel from \"./Channel\";\nimport MultiChannel from \"./MultiChannel\";\nimport SimpleStore from \"./stores/SimpleStore\";\nimport retry from \"./helpers/retry\";\n\nconst CHANNEL2_SUFFIX = \"-2\";\nconst config = {\n\tstore: null,\n\ticeServers: [{ urls: \"stun:stun.l.google.com:19302\" }],\n\ttimeout: 10000\n};\nconst webrtc = new WebRTC(config);\n\nexport { SimpleStore };\n\nexport default {\n\tasync createChannel() {\n\t\tconst channel1 = await this.createSingleChannel();\n\t\tconst channel = new MultiChannel(channel1);\n\n\t\tretry(channel, \"$waitChannel2\", async () => {\n\t\t\tconst channel2 = await this.joinSingleChannel(\n\t\t\t\tchannel.token + CHANNEL2_SUFFIX\n\t\t\t);\n\t\t\tchannel.connect(channel2);\n\t\t});\n\n\t\treturn channel;\n\t},\n\n\tasync joinChannel(token) {\n\t\tconst channel1 = await this.joinSingleChannel(token);\n\t\tconst channel2 = await this.createSingleChannel(token + CHANNEL2_SUFFIX);\n\n\t\treturn new MultiChannel(channel1, channel2);\n\t},\n\n\tasync createSingleChannel(id) {\n\t\tconst channel = new Channel(id);\n\n\t\tconst {\n\t\t\tconnection,\n\t\t\tdataChannel\n\t\t} = await webrtc.createConnectionWithOffer();\n\n\t\twebrtc.setConnectHandler(connection, dataChannel, channel);\n\t\twebrtc.setDisconnectHandler(connection, channel);\n\t\twebrtc.setWaitHandler(connection, channel, () =>\n\t\t\twebrtc.setUpTimeoutFor(channel)\n\t\t);\n\n\t\tawait webrtc.saveOffer(connection, channel);\n\n\t\treturn channel;\n\t},\n\n\tasync joinSingleChannel(token) {\n\t\tconst channel = new Channel(token);\n\n\t\tconst offer = await webrtc.getOffer(channel);\n\t\tconst connection = await webrtc.createConnectionWithAnswer(offer);\n\t\tawait webrtc.saveAnswer(connection, channel);\n\t\twebrtc.setUpTimeoutFor(channel);\n\n\t\tconnection.ondatachannel = ({ channel: dataChannel }) => {\n\t\t\twebrtc.setConnectHandler(connection, dataChannel, channel);\n\t\t};\n\t\twebrtc.setDisconnectHandler(connection, channel);\n\n\t\treturn channel;\n\t},\n\n\tsetStore(newStore) {\n\t\tconfig.store = newStore;\n\t},\n\n\tsetIceServers(newIceServers) {\n\t\tconfig.iceServers = newIceServers;\n\t},\n\n\tsetTimeout(newTimeout) {\n\t\tconfig.timeout = newTimeout;\n\t}\n};\n","import querystring from \"querystring\";\n\nexport default {\n\tgetBaseUrl() {\n\t\treturn window.location.href\n\t\t\t.replace(window.location.hash, \"\")\n\t\t\t.replace(window.location.search, \"\");\n\t},\n\tgetQueryString() {\n\t\treturn querystring.parse(window.location.search.replace(\"?\", \"\"));\n\t}\n};\n","import React, { Component } from \"react\";\nimport utils from \"../utils\";\nimport quickp2p from \"../lib\";\n\nexport default class Create extends Component {\n\tstate = { token: null };\n\n\trender() {\n\t\tif (!this.state.token) return <div>Wait...</div>;\n\n\t\treturn (\n\t\t\t<div>\n\t\t\t\tSend this link to your peer and wait...\n\t\t\t\t<br />\n\t\t\t\t<br />\n\t\t\t\t<a href={this.link}>{this.link}</a>\n\t\t\t</div>\n\t\t);\n\t}\n\n\tasync componentDidMount() {\n\t\tif (window.channel) window.channel.disconnect();\n\n\t\twindow.channel = this.channel = await quickp2p.createChannel();\n\t\tthis.setState({ token: this.channel.token });\n\n\t\tthis.channel.on(\"connected\", () => {\n\t\t\twindow.location.hash = \"#/chat\";\n\t\t});\n\n\t\tthis.channel.on(\"timeout\", () => {\n\t\t\talert(\"TIMEOUT!\");\n\t\t\twindow.location.hash = \"#/\";\n\t\t});\n\t}\n\n\tget link() {\n\t\tconst url = utils.getBaseUrl();\n\t\treturn `${url}?token=${this.state.token}#/join`;\n\t}\n}\n","import React, { Component } from \"react\";\nimport utils from \"../utils\";\nimport quickp2p from \"../lib\";\n\nexport default class Join extends Component {\n\trender() {\n\t\tif (!this.inviteToken) return <div>Invalid token.</div>;\n\n\t\treturn <div>Wait...</div>;\n\t}\n\n\tasync componentDidMount() {\n\t\tif (!this.inviteToken) return;\n\t\tif (window.channel) window.channel.disconnect();\n\n\t\twindow.channel = this.channel = await quickp2p.joinChannel(\n\t\t\tthis.inviteToken\n\t\t);\n\n\t\tthis.channel.on(\"connected\", () => {\n\t\t\twindow.channel = this.channel;\n\t\t\twindow.location.hash = \"#/chat\";\n\t\t});\n\n\t\tthis.channel.on(\"timeout\", () => {\n\t\t\talert(\"TIMEOUT!\");\n\t\t\twindow.location.hash = \"#/\";\n\t\t});\n\t}\n\n\tget inviteToken() {\n\t\treturn utils.getQueryString().token || null;\n\t}\n}\n","import React, { Component } from \"react\";\n\nexport default class Chat extends Component {\n\tstate = { messages: [], input: \"\" };\n\n\trender() {\n\t\tif (!window.channel) return <div>No connection.</div>;\n\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<textarea\n\t\t\t\t\tvalue={this.state.messages.join(\"\\n\")}\n\t\t\t\t\treadOnly\n\t\t\t\t\trows={15}\n\t\t\t\t\tref={(textarea) => (this.textarea = textarea)}\n\t\t\t\t\tstyle={{ width: \"100%\" }}\n\t\t\t\t/>\n\t\t\t\t<br />\n\t\t\t\t<input\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tvalue={this.state.input}\n\t\t\t\t\tonChange={(e) => {\n\t\t\t\t\t\tthis.setState({ input: e.target.value });\n\t\t\t\t\t}}\n\t\t\t\t\tonKeyDown={(e) => {\n\t\t\t\t\t\tconst { input } = this.state;\n\n\t\t\t\t\t\tif (e.key === \"Enter\" && input) {\n\t\t\t\t\t\t\twindow.channel.send(input);\n\t\t\t\t\t\t\tthis.setState({ input: \"\" });\n\t\t\t\t\t\t\tthis._addMessage(`Me: ${input}`);\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t\t\tref={(input) => (this.input = input)}\n\t\t\t\t\tstyle={{ width: \"100%\" }}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t);\n\t}\n\n\tcomponentDidMount() {\n\t\tconst channel = window.channel;\n\t\tif (!channel) return;\n\n\t\tchannel.on(\"data\", (data) => {\n\t\t\tthis._addMessage(`Stranger: ${data}`);\n\t\t});\n\n\t\tchannel.on(\"disconnected\", () => {\n\t\t\talert(\"DISCONNECTED!\");\n\t\t\twindow.location.hash = \"#/\";\n\t\t});\n\n\t\tthis.input.focus();\n\t}\n\n\tcomponentWillUnmount() {\n\t\tif (!window.channel) return;\n\n\t\twindow.channel.disconnect();\n\t\twindow.channel = undefined;\n\t}\n\n\t_addMessage(content) {\n\t\tthis.setState(\n\t\t\t{\n\t\t\t\tmessages: [...this.state.messages, content]\n\t\t\t},\n\t\t\t() => {\n\t\t\t\tthis.textarea.scrollTop = this.textarea.scrollHeight;\n\t\t\t}\n\t\t);\n\t}\n}\n","import React, { Component } from \"react\";\nimport quickp2p, { SimpleStore } from \"./lib\";\nimport Create from \"./screens/Create\";\nimport Join from \"./screens/Join\";\nimport Chat from \"./screens/Chat\";\n\nquickp2p.setStore(new SimpleStore(\"https://misc.r-labs.io\"));\n\nexport default class App extends Component {\n\trender() {\n\t\tconst route = window.location.hash;\n\n\t\tif (route.startsWith(\"#/create\")) return <Create />;\n\t\tif (route.startsWith(\"#/join\")) return <Join />;\n\t\tif (route.startsWith(\"#/chat\")) return <Chat />;\n\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<h1>Valid urls:</h1>\n\t\t\t\t<a href=\"#/create\">/#/create</a>\n\t\t\t\t<br />\n\t\t\t\t/#/join?token=INVITE_TOKEN\n\t\t\t\t<br />\n\t\t\t\t<br />>{\" \"}\n\t\t\t\t<a\n\t\t\t\t\thref=\"https://github.com/rodri042/quickp2p\"\n\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\trel=\"noopener noreferrer\"\n\t\t\t\t>\n\t\t\t\t\tSource code and instructions\n\t\t\t\t</a>\n\t\t\t</div>\n\t\t);\n\t}\n\n\tcomponentWillMount() {\n\t\tthis._listener = window.addEventListener(\"hashchange\", (e) => {\n\t\t\tthis.forceUpdate();\n\t\t});\n\t}\n\n\tcomponentWillUnmount() {\n\t\twindow.removeEventListener(\"hashchange\", this._listener);\n\t}\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n"],"sourceRoot":""}